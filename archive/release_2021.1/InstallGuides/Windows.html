<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>InstallGuides/Windows - Chaste</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="/trac-static/css/trac.css" type="text/css" />
    <link rel="stylesheet" href="/trac-static/css/wiki.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/trac-static/css/site.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <p>
          <a id="logo" href="http://www.cs.ox.ac.uk/chaste"><img src="/logos/chaste-266x60.jpg" alt="Chaste logo" height="60" width="266" /></a>
          <em>Documentation for <a href="/chaste/tutorials/release_2021.1/">Release 2021.1</a>.</em>
        </p>
      </div>
    </div>
    <p>&nbsp;</p>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <div id="wikipage" class="trac-content"><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <a href="#Newinstructionsincomplete">New instructions (incomplete)</a>
    <ol>
      <li>
        <a href="#Prerequisites">Prerequisites</a>
      </li>
      <li>
        <a href="#SettingupVcpkg">Setting up Vcpkg</a>
      </li>
      <li>
        <a href="#InstallChastedependencies">Install Chaste dependencies</a>
      </li>
      <li>
        <a href="#Usingtheinstalledpackages">Using the installed packages</a>
      </li>
      <li>
        <a href="#Workinprogress">Work in progress</a>
      </li>
    </ol>
  </li>
  <li>
    <a href="#Oldinstructions">Old instructions</a>
  </li>
  <li>
    <a href="#InstallingChasteonWindows">Installing Chaste on Windows</a>
    <ol>
      <li>
        <a href="#Installbuildtools">Install build tools</a>
      </li>
      <li>
        <a href="#InstallMPI">Install MPI</a>
      </li>
      <li>
        <a href="#DownloadSourcecodeandchoosepaths">Download Source code and choose paths</a>
      </li>
      <li>
        <a href="#BuildremainingdependenciesandChaste">Build remaining dependencies and Chaste</a>
      </li>
      <li>
        <a href="#BuildChasteitself">Build Chaste itself</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<h1 id="Newinstructionsincomplete">New instructions (incomplete)</h1>
<p>
Microsoft have recently developed a C++ package manager (<a class="ext-link" href="https://github.com/Microsoft/vcpkg"><span class="icon">​</span>vcpkg</a>), and begun integrating CMake with Visual Studio.
</p>
<h2 id="Prerequisites">Prerequisites</h2>
<p>
Before following this guide, make sure you have the following installed:
</p>
<ul><li><a class="ext-link" href="https://www.visualstudio.com/vs/community/"><span class="icon">​</span>Visual Studio Community 2017</a>, or Visual Studio 2015 (update 3)
</li><li><a class="ext-link" href="https://msdn.microsoft.com/en-us/library/bb524831(v=vs.85).aspx"><span class="icon">​</span>Microsoft MPI</a>
</li><li>A Fortran compiler (for building PETSc): either <a class="ext-link" href="https://software.intel.com/en-us/intel-parallel-studio-xe"><span class="icon">​</span>Intel</a> or <a class="ext-link" href="https://www.pgroup.com/products/community.htm"><span class="icon">​</span>PGI</a>. Note that the PGI community edition is available for free, but may not support the latest version of Visual Studio.
</li><li><a class="ext-link" href="https://git-scm.com/download/win"><span class="icon">​</span>Git for Windows</a>
</li><li>The latest version of <a class="ext-link" href="https://cmake.org/download/"><span class="icon">​</span>CMake</a>
</li></ul><h2 id="SettingupVcpkg">Setting up Vcpkg</h2>
<p>
Start a Visual Studio developer command prompt as administrator, and navigate to the directory in which you want to install dependencies:
</p>
<pre class="wiki">git clone -b fortran-ports https://github.com/albertziegenhagel/vcpkg.git
cd vcpkg
.\bootstrap-vcpkg.bat
.\vcpkg integrate install
</pre><p>
Open the file <tt>path\to\vcpkg\triplets\x64-windows.cmake</tt> and add the following line:
</p>
<pre class="wiki">set(VCPKG_FORTRAN_COMPILER &lt;compiler&gt;)
</pre><p>
where &lt;compiler&gt; is either <tt>Intel</tt> or <tt>PGI</tt> (case sensitive), depending on whether you installed the Intel or PGI Fortran compiler.
</p>
<h2 id="InstallChastedependencies">Install Chaste dependencies</h2>
<p>
From the vcpkg home directory, type
</p>
<pre class="wiki">.\vcpkg install petsc:x64-windows hdf5:x64-windows sundials:x64-windows vtk:x64-windows boost:x64-windows
</pre><p>
This will take several hours.
</p>
<h2 id="Usingtheinstalledpackages">Using the installed packages</h2>
<p>
Provided you did the <tt>integrate install</tt> step with administrator privileges above, everything should work as if by magic:
</p>
<pre class="wiki">All C++ projects can now #include any installed libraries.
Linking will be handled automatically.
Installing new libraries will make them instantly available.
</pre><h2 id="Workinprogress">Work in progress</h2>
<h1 id="Oldinstructions">Old instructions</h1>
<h1 id="InstallingChasteonWindows">Installing Chaste on Windows</h1>
<p>
<em>Note: the Windows installation is new, and has not yet been tested end-to-end on a clean machine. We would welcome feedback on whether it works for you! </em>
</p>
<p>
The latest development version of Chaste has support for building on Windows using Microsoft Visual Studio and CMake.
Currently we run <a href="/trac/tests.py/recent?type=nightly&amp;start=0&amp;machine=scratch.cs.ox.ac.uk">automated tests</a> on a Windows 7 machine using Visual Studio 2010.
</p>
<p>
<strong>Ozzy is testing this on Windows 8.1 With Visual Studio 2012</strong>
</p>
<p>
There is a document giving background to the Windows port at <a class="source" href="/trac/browser/trunk/docs/Windows">source:trunk/docs/Windows</a>.
The instructions below are a newer (and somewhat experimental) version, and are more streamlined.
</p>
<p>
Chaste's third party dependencies need to be built with compatible compiler &amp; linker flags or Chaste will fail to link.
However, this is largely taken care of for you by a set of CMake scripts that build everything.
</p>
<p>
<strong>NB.</strong> Building Chaste and all its third party dependencies requires a <em>lot</em> of disk space - roughly 100GB on our machine!
</p>
<h2 id="Installbuildtools">Install build tools</h2>
<p>
You will need:
</p>
<ol><li>CMake (from <a class="ext-link" href="http://www.cmake.org"><span class="icon">​</span>http://www.cmake.org</a>, at least version 2.8)
<ul><li> <strong> I used the cmake-2.8.12.1-win32-x86.exe installer and added CMake to the system PATH for current user</strong>
</li></ul></li><li>A command-line SVN client (e.g. free SlikSVN from <a class="ext-link" href="http://www.sliksvn.com/en/download/"><span class="icon">​</span>http://www.sliksvn.com/en/download/</a>)
<ul><li><strong>I used Slik-Subversion-1.8.5-x64.exe</strong>
</li></ul></li><li>Visual Studio C++ compiler (2010 or 2012 version)
<ul><li><strong> I'm using Visual Studio 2013</strong>
</li></ul></li><li>Python 2.7.x (from <a class="ext-link" href="http://python.org/download/"><span class="icon">​</span>http://python.org/download/</a>)
<ul><li><strong> I'm using python-2.7.6.amd64.exe with default settings</strong>
</li></ul></li><li>(Optional) Cygwin (from <a class="ext-link" href="http://cygwin.com"><span class="icon">​</span>http://cygwin.com</a>, for PETSc configuration)
<ul><li><strong> I haven't installed this </strong>
</li></ul></li></ol><p>
The Chaste CMake scripts can install Cygwin for you if desired, using the <tt>-DAUTO_INSTALL_CYGWIN:BOOL=ON</tt> flag.
If installing it yourself, make sure that you include the following packages: <tt>mingw64-i686-gcc-core, gendef, python, cmake, make</tt>.
</p>
<p>
Note that the native Windows Python <strong>must</strong> appear before Cygwin's Python on your (Windows) PATH, or the PETSc configuration will fail.
</p>
<h2 id="InstallMPI">Install MPI</h2>
<p>
Download the relevant stand-alone, and redistributable, installer for the Microsoft MPI implementation from <a class="ext-link" href="http://www.microsoft.com/en-gb/download/details.aspx?id=36045"><span class="icon">​</span>http://www.microsoft.com/en-gb/download/details.aspx?id=36045</a>
</p>
<p>
For a 64-bit build (the only supported option for Chaste) install mpi_x64.msi.
</p>
<p>
A typical install path is "<tt>C:\Program Files\Microsoft HPC Pack 2012\</tt>".
Note however that PETSc will not be able to find MPI if the path supplied contains spaces!
We recommend circumventing this problem by creating a soft link to the MPI installation, for example by running the following command from a Windows command prompt (<strong>Opening the command prompt as administrator</strong>):
</p>
<pre class="wiki">C:\&gt; mklink /D MS_HPC_PACK_2012 "C:\Program Files\Microsoft HPC Pack 2012"
</pre><p>
This creates a soft link named <tt>MS_HPC_PACK_2012</tt> at the root of the C: drive, that points at the Microsoft MPI installation directory.
</p>
<ul><li><strong> I installed the mpi_x64.msi file </strong>
</li></ul><h2 id="DownloadSourcecodeandchoosepaths">Download Source code and choose paths</h2>
<p>
Decide where you're going to build Chaste, and where you'll put the source.
These should be near the root folder of a drive, since MSVC (especially version 10) has a relatively short limit on compiler command line lengths!
</p>
<p>
<strong> Add instructions to get chaste source code using SilkSVN</strong>
</p>
<p>
The instructions below assume you've created an empty folder <tt>D:\Chaste\build</tt> in which to build everything, and have unpacked the Chaste source tree in <tt>D:\Chaste\source</tt>.
Change the relevant paths to suit your setup.
</p>
<h2 id="BuildremainingdependenciesandChaste">Build remaining dependencies and Chaste</h2>
<p>
You'll want to launch the Visual Studio Command Prompt (called 'Developer Command Prompt' in VS2013) in order to run the following commands, and may need administrator privileges:
</p>
<pre class="wiki">D:
cd \Chaste\build
cmake -G "Visual Studio 10 Win64" D:/Chaste/source/cmake
# or cmake -G "Visual Studio 10 Win64" -DAUTO_INSTALL_CYGWIN:BOOL=ON D:/Chaste/source/cmake
cmake --build .
</pre><p>
Note that the above <strong>will not</strong> work if run from Cygwin.  Note also that you <strong>do</strong> need forward slashes in the cmake command arguments.
</p>
<p>
<strong>Ozzy Modified cmake\third_party_libs\CMakeLists.txt to comment out the conditional on AUTO_INSTALL_CYGWIN and 
used </strong>
</p>
<pre class="wiki">cmake -G "Visual Studio 11 Win64" C:/Chaste/source/trunk/cmake
</pre><p>
<strong>due to the different VS version and path.  VS2013 needs '12' instead of '11'.</strong>
</p>
<p>
<em>You may need to specify the version of MSVC used to the Boost build, by editing cmake/third_party_libs/CMakeLists.txt about line 243 and appending a version to the 'toolset=msvc' argument, e.g. 'toolset=msvc-12.0' for VS2013.</em>
</p>
<p>
<em>At present there appears to be an issue where the VTK install partially fails.  However, it does install sufficiently that the Chaste build works, i.e. you can continue with the next section.</em>
</p>
<h2 id="BuildChasteitself">Build Chaste itself</h2>
<p>
Once the initial install of dependencies is complete, you can just build (and test) Chaste by itself, for example using:
</p>
<pre class="wiki">D:
cd \Chaste\build\chaste
# If the VTK install gave errors, you'll also need the following line. It shouldn't hurt to include it in case...
cmake -G "Visual Studio 10 Win64" D:/Chaste/source   # Adjust the '10' as above
cmake --build .
</pre><p>
Other flags may be supplied to the cmake invocations as follows (note the trailing full stops are part of the command):
</p>
<ul><li><tt>cmake -DRUN_TESTS:BOOL=OFF -DTEST_MPIEXEC_ENABLED:BOOL=ON .</tt> : configure Chaste to build the tests and set them to run on 2 processes rather than 1.  You then need to use "<tt>cmake --build .</tt>" to do the actual building.
</li><li><tt>cmake -DRUN_TESTS:BOOL=ON -DTEST_FAMILY:STRING="Continuous" .</tt> : this will run tests within the given test family that have previously been built.
</li></ul><p>
Once you've used CMake to configure Chaste (i.e. running one of the commands that doesn't include <tt>--build</tt>) you can use the Visual Studio GUI to build Chaste, and also run/debug individual tests.
Load <tt>D:\Chaste\build\chaste\Chaste.sln</tt> as the solution file.
</p>
<p>
Running debug just by hitting F5 never does the right thing - generally it tries to run 'ALL_BUILD' and hence will ask to build everything that's not up-to-date, then give an error because there's no such executable. Instead, right-click on the test you want then select Debug-&gt;Start new instance. 
</p>
</div>
          

    </div>
  </body>
</html>
