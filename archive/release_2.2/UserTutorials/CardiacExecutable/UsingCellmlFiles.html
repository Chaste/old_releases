<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>UserTutorials/CardiacExecutable/UsingCellmlFiles - Chaste</title>
    <link rel="stylesheet" href="https://chaste.github.io/old_releases/trac.css" type="text/css" />
    <link rel="stylesheet" href="https://chaste.github.io/old_releases/wiki.css" type="text/css" />
    <link rel="stylesheet" href="/trac/css/site.css" type="text/css" />
    <style type="text/css">
/* Link styles */
:link, :visited, a em {
 text-decoration: none;
 color: #283f6b;
 border-bottom: 1px dotted #bbb;
}
/*
:link:hover, :visited:hover {
 background-color: #eee;
 color: #555;
}
*/
    </style>

  </head>
  <body>
    <div id="banner">
      <div id="header">
        <p>
          <a id="logo" href="https://chaste.github.io/"><img src="https://chaste.github.io/chaste_0256.png" alt="Chaste logo" height="60" /></a>
          <em>Documentation for <a href="https://chaste.github.io/old_releases/release_2.2/">Release 2.2</a>.</em>
        </p>
      </div>
    </div>
    <p>&nbsp;</p>
    <div id="content" class="wiki">
      <p class="path noprint">
        <a class="pathentry" title="View UserTutorials" href="https://chaste.github.io/old_releases/release_2.2/UserTutorials.html">UserTutorials</a><span class="pathentry sep">/</span><a class="pathentry" title="View UserTutorials/CardiacExecutable" href="https://chaste.github.io/old_releases/release_2.2/UserTutorials/CardiacExecutable.html">CardiacExecutable</a><span class="pathentry sep">/</span><a class="pathentry" title="View UserTutorials/CardiacExecutable/UsingCellmlFiles" href="https://chaste.github.io/old_releases/release_2.2/UserTutorials/CardiacExecutable/UsingCellmlFiles.html">UsingCellmlFiles</a>
        <br style="clear: both" />
      </p>
      <div class="wikipage searchable">
        
          <p>
The executable can be used with a general CellML file to specify the cell model, rather than just choosing from the list of hardcoded cell model options (although some names in the CellML file have to match the names Chaste is expecting). However, in order to run Chaste with CellML files, a full developer installation is (currently) required, as PyCml is used to convert the CellML into code which is then compiled and dynamically loaded, all when running the executable.
</p>
<p>
To run a simulation with this, you have to provide the path and name of the CellML model as follows.
</p>
<div class="code"><pre><span class="nt">&lt;IonicModels&gt;</span>
    <span class="nt">&lt;Default&gt;&lt;Dynamic&gt;&lt;Path</span> <span class="na">relative_to=</span><span class="s">"cwd"</span><span class="nt">&gt;</span>LuoRudy1991.cellml<span class="nt">&lt;/Path&gt;&lt;/Dynamic&gt;&lt;/Default&gt;</span>
<span class="nt">&lt;/IonicModels&gt;</span>
</pre></div><p>
In this example, the file <tt>LuoRudy1991.cellml</tt> should be placed in the same folder as the <tt>UsingCellmlFiles.xml</tt> file,
which should be your current directory when running the simulation.
</p>
<p>
The executable can also output any of the variables that are used in the cell model. The following block needs to be added to the <tt>Simulation</tt> block of <tt>UsingCellmlFiles.xml</tt>. 
</p>
<div class="code"><pre><span class="nt">&lt;OutputVariables&gt;</span>
    <span class="nt">&lt;Var</span> <span class="na">name=</span><span class="s">"Cai"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Var</span> <span class="na">name=</span><span class="s">"Nai"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/OutputVariables&gt;</span>
</pre></div><p>
The name should match the name of the variable in the CellML file. Also, you have to alter the CellML file to tell PyCml which variables or quantities can be selected for output. Each variable must have a <tt>cmeta:id</tt> specified 
</p>
<div class="code"><pre><span class="nt">&lt;variable</span> <span class="na">units=</span><span class="s">"millimolar"</span> <span class="na">public_interface=</span><span class="s">"out"</span> <span class="na">name=</span><span class="s">"Cai"</span> <span class="na">initial_value=</span><span class="s">"0.0002"</span> <span class="na">cmeta:id=</span><span class="s">"Cai"</span><span class="nt">/&gt;</span>
</pre></div><p>
and an RDF annotation added, e.g.
</p>
<div class="code"><pre><span class="nt">&lt;rdf:Description</span> <span class="na">rdf:about=</span><span class="s">"#Cai"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;derived-quantity</span> <span class="na">xmlns=</span><span class="s">"https://chaste.comlab.ox.ac.uk/cellml/ns/pycml#"</span><span class="nt">&gt;</span>yes<span class="nt">&lt;/derived-quantity&gt;</span>
<span class="nt">&lt;/rdf:Description&gt;</span>
</pre></div><p>
which for convenience can be placed at the end of the CellML file.  See <a class="wiki" href="https://chaste.github.io/old_releases/release_2.2/ChasteGuides/CodeGenerationFromCellML.html">ChasteGuides/CodeGenerationFromCellML</a> for full details of the functionality available.  The <a class="wiki" href="https://chaste.github.io/old_releases/release_2.2/ChasteGuides/TroubleShooting.html#PyCmlerrors">PyCml section of the TroubleShooting page</a> may be useful if you experience problems.
</p>
<p>
The attached files run a simple one-dimensional simulation, with the <tt>LuoRudy1991.cellml</tt> file modified in order to allow the output ot the intracellular calcium and sodium concentrations. Ionic currents and other quantities of interest can be also selected in the same way.
</p>

        
        
      </div>
          <h3>Attachments</h3>
          <ul>
              <li>
      <a href="https://chaste.github.io/old_releases/release_2.2/UserTutorials/CardiacExecutable/UsingCellmlFiles/UsingCellmlFiles.tgz" title="View attachment">UsingCellmlFiles.tgz</a>
      (<span title="19299 bytes">18.8 KB</span>)
                <q>Simulation files for <tt>UsingCellmlFiles</tt> tutorial</q>
              </li>
          </ul>

    </div>
  </body>
</html>
